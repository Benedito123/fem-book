
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Abstract notation for variational formulations</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Introduction to Numerical Methods for Variational Problems" href="index.html" />
    <link rel="next" title="Examples on variational formulations" href="._book017.html" />
    <link rel="prev" title="Variational formulations with global basis functions" href="._book015.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book017.html" title="Examples on variational formulations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book015.html" title="Variational formulations with global basis functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Introduction to Numerical Methods for Variational Problems</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="abstract-notation-for-variational-formulations">
<span id="fem-deq-1d-varform-abstract"></span><h1>Abstract notation for variational formulations<a class="headerlink" href="#abstract-notation-for-variational-formulations" title="Permalink to this headline">¶</a></h1>
<p>We have seen that variational formulations end up with a formula involving
<span class="math">\(u\)</span> and <span class="math">\(v\)</span>, such as <span class="math">\((u',v')\)</span> and a formula involving <span class="math">\(v\)</span> and known
functions, such as <span class="math">\((f,v)\)</span>. A widely used notation is to introduce an abstract
variational statement written as</p>
<div class="math">
\[a(u,v)=L(v)\quad\forall v\in V,\]</div>
<p>where <span class="math">\(a(u,v)\)</span> is a so-called <em>bilinear form</em> involving all the terms
that contain both the test and trial
function, while <span class="math">\(L(v)\)</span> is a <em>linear form</em> containing all the terms without
the trial function. For example, the statement</p>
<div class="math">
\[\int_{\Omega} u' v' {\, \mathrm{d}x} =
\int_{\Omega} fv{\, \mathrm{d}x}\quad\hbox{or}\quad (u',v') = (f,v)
\quad\forall v\in V\]</div>
<p>can be written in abstract form: <em>find  \( u \)  such that</em></p>
<div class="math">
\[a(u,v) = L(v)\quad \forall v\in V,\]</div>
<p>where we have the definitions</p>
<div class="math">
\[a(u,v) = (u',v'),\quad L(v) = (f,v){\thinspace .}\]</div>
<p>The term <em>linear</em> means that</p>
<div class="math">
\[L(\alpha_1 v_1 + \alpha_2 v_2) =\alpha_1 L(v_1) + \alpha_2 L(v_2)\]</div>
<p>for two test functions <span class="math">\(v_1\)</span> and <span class="math">\(v_2\)</span>, and
scalar parameters <span class="math">\(\alpha_1\)</span> and <span class="math">\(\alpha_2\)</span>. Similarly, the term <em>bilinear</em>
means that <span class="math">\(a(u,v)\)</span> is linear in both its arguments:</p>
<div class="math">
\[\begin{split}\begin{align*}
a(\alpha_1 u_1 + \alpha_2 u_2, v) &amp;= \alpha_1 a(u_1,v) + \alpha_2 a(u_2, v),
\\
a(u, \alpha_1 v_1 + \alpha_2 v_2) &amp;= \alpha_1 a(u,v_1) + \alpha_2 a(u, v_2)
{\thinspace .}
\end{align*}\end{split}\]</div>
<p>In nonlinear problems these linearity properties do not hold in general
and the abstract notation is then</p>
<div class="math">
\[F(u;v)=0\quad\forall v\in V{\thinspace .}\]</div>
<p>The matrix system associated with <span class="math">\(a(u,v)=L(v)\)</span> can also be written in
an abstract form by inserting <span class="math">\(v={\psi}_i\)</span> and <span class="math">\(u=\sum_j c_j{\psi}_j\)</span>
in <span class="math">\(a(u,v)=L(v)\)</span>. Using the linear properties, we get</p>
<div class="math">
\[\sum_{j\in{\mathcal{I}_s}} a({\psi}_j,{\psi}_i) c_j = L({\psi}_i),\quad i\in{\mathcal{I}_s},\]</div>
<p>which is a linear system</p>
<div class="math">
\[\sum_{j\in{\mathcal{I}_s}}A_{i,j}c_j = b_i,\quad i\in{\mathcal{I}_s},\]</div>
<p>where</p>
<div class="math">
\[A_{i,j} =a({\psi}_j,{\psi}_i), \quad b_i = L({\psi}_i){\thinspace .}\]</div>
<p>In many problems, <span class="math">\(a(u,v)\)</span> is symmetric such that
<span class="math">\(a({\psi}_j,{\psi}_i) = a({\psi}_i,{\psi}_j)\)</span>. In those cases the
coefficient matrix becomes symmetric, <span class="math">\(A_{i,j}=A_{j,i}\)</span>, a property
that can simplify solution algorithms for linear systems
and make them more stable. The property also reduces memory
requirements and the computational work.</p>
<p>The abstract notation <span class="math">\(a(u,v)=L(v)\)</span> for linear differential equation problems
is much used in the literature and
in description of finite element software (in particular the
<a class="reference external" href="http://fenicsproject.org">FEniCS</a> documentation). We shall
frequently summarize variational forms using this notation.</p>
</div>
<div class="section" id="variational-problems-and-minimization-of-functionals">
<span id="fem-deq-1d-optimization"></span><h1>Variational problems and minimization of functionals<a class="headerlink" href="#variational-problems-and-minimization-of-functionals" title="Permalink to this headline">¶</a></h1>
<div class="section" id="example-4">
<h2>Example<a class="headerlink" href="#example-4" title="Permalink to this headline">¶</a></h2>
<p>Many physical problems can be modeled as  partial differential equations
and as  minimization problems. For example, the deflection <span class="math">\(u(x)\)</span> of an
elastic string subject to a transversal force <span class="math">\(f(x)\)</span>
is governed by the differential equation problem</p>
<div class="math">
\[-u''(x) = f(x),\quad x\in (0,L),\quad x(0)=x(L)=0{\thinspace .}\]</div>
<p>Equivalently, the deflection <span class="math">\(u(x)\)</span> is the function <span class="math">\(v\)</span> that minimizes
the potential energy <span class="math">\(F(v)\)</span> in a string,</p>
<div class="math">
\[F(v) = \frac{1}{2}\int_0^L \left((v')^2 - fv\right){\, \mathrm{d}x}{\thinspace .}\]</div>
<p>That is, <span class="math">\(F(u) = \min_{v\in V}F(v)\)</span>. The quantity <span class="math">\(F(v)\)</span> is called a
functional: it takes one or more functions as input and produces a
number. Loosely speaking, we may say that a functional is
&#8220;a function of functions&#8221;. Functionals very often involve
integral expressions as above.</p>
<p>A range of physical problems can be formulated either as a differential
equation or as a minimization of some functional. Quite often, the differential
equation arises from Newton&#8217;s 2nd law of motion while the functional
expresses a certain kind of energy.</p>
<p>Many traditional applications of the finite element method, especially
in solid mechanics and constructions with beams and plates, start with
formulating <span class="math">\(F(v)\)</span> from physical principles, such as minimization of
elastic energy, and then proceeds with deriving <span class="math">\(a(u,v)=L(v)\)</span>, which
is the formulation usually desired in software implementations.</p>
</div>
<div class="section" id="the-general-minimization-problem">
<h2>The general minimization problem<a class="headerlink" href="#the-general-minimization-problem" title="Permalink to this headline">¶</a></h2>
<p>The relation between a differential equation and minimization of a functional
can be expressed in a general mathematical way using our abstract
notation for a variational form: <span class="math">\(a(u,v)=L(v)\)</span>.
It can be shown that the variational statement</p>
<div class="math">
\[a(u,v)=L(v)\quad\forall v\in V,\]</div>
<p>is equivalent to minimizing the functional</p>
<div class="math">
\[F(v) = {\frac{1}{2}}a(v,v) - L(v)\]</div>
<p>over all functions <span class="math">\(v\in V\)</span>. That is,</p>
<div class="math">
\[F(u)\leq F(v)\quad \forall v\in V{\thinspace .}\]</div>
</div>
<div class="section" id="derivation">
<h2>Derivation<a class="headerlink" href="#derivation" title="Permalink to this headline">¶</a></h2>
<p>[<strong>kam 9</strong>: need that F is convex and a is positive, symmetric, right? Check]</p>
<p>To see this, we write <span class="math">\(F(u)\leq F(\eta)\)</span>, <span class="math">\(\forall\eta\in V\)</span> instead
and set <span class="math">\(\eta=u + \epsilon v\)</span>, where <span class="math">\(v\in V\)</span> is an
arbitrary function in <span class="math">\(V\)</span>.
For any given arbitrary <span class="math">\(v\)</span>, we can view <span class="math">\(F(v)\)</span> as a function <span class="math">\(g(\epsilon)\)</span>
and find the extrema of <span class="math">\(g\)</span>, which is a function of one variable.
We have</p>
<div class="math">
\[F(\eta) = F(u+\epsilon v) = \frac{1}{2} a(u+\epsilon v,u + \epsilon v) - L(u + \epsilon v){\thinspace .}\]</div>
<p>From the linearity of <span class="math">\(a\)</span> and <span class="math">\(L\)</span> we get</p>
<div class="math">
\[\begin{split}\begin{align*}
g(\epsilon) &amp;= F(u+\epsilon u)\\
&amp;= \frac{1}{2} a(u + \epsilon v, u+\epsilon v) - L(u + \epsilon v)\\
&amp;= \frac{1}{2} a(u, u+\epsilon v) + \frac{1}{2} \epsilon a(v, u+\epsilon u) - L(u) - \epsilon L(v)\\
&amp;= \frac{1}{2} a(u, u) + \frac{1}{2} \epsilon a(u,v) + \frac{1}{2}\epsilon a(v, u) +
\frac{1}{2}\epsilon^2 a(v,v) - L(u) - \epsilon L(v){\thinspace .}
\end{align*}\end{split}\]</div>
<p>If we now assume that <span class="math">\(a\)</span> is symmetric, <span class="math">\(a(u,v)=a(v,u)\)</span>, we can write</p>
<div class="math">
\[g(\epsilon) = \frac{1}{2} a(u,u) + \epsilon a(u,v) + \frac{1}{2}\epsilon^2 a(v,v) -
L(u) -\epsilon L(v){\thinspace .}\]</div>
<p>The extrema of <span class="math">\(g\)</span> is found by searching for <span class="math">\(\epsilon\)</span> such that
<span class="math">\(g'(\epsilon)=0\)</span>:</p>
<div class="math">
\[g'(\epsilon) = a(u,v) - L(v) + \epsilon a(v,v) = 0{\thinspace .}\]</div>
<p>This linear equation in <span class="math">\(\epsilon\)</span> has a solution <span class="math">\(\epsilon = (a(u,v) - L(u))/a(v,v)\)</span> if <span class="math">\(a(v,v) &gt; 0\)</span>. But recall that <span class="math">\(a(u,v)=L(v)\)</span> for any <span class="math">\(v\)</span>, so
we must have <span class="math">\(\epsilon =0\)</span>. Since the reasoning above holds for any <span class="math">\(v\in V\)</span>,
the function <span class="math">\(\eta = u+\epsilon v\)</span> that makes <span class="math">\(F(\eta)\)</span> extreme must have
<span class="math">\(\epsilon=0\)</span>, i.e., <span class="math">\(\eta = u\)</span>, the solution of <span class="math">\(a(u,v)=L(v)\)</span> for any <span class="math">\(v\)</span> in
<span class="math">\(V\)</span>.</p>
<p>Looking at <span class="math">\(g''(\epsilon) = a(v,v)\)</span>, we realize that <span class="math">\(\epsilon=0\)</span> corresponds
to a unique minimum if <span class="math">\(a(v,v)&gt;0\)</span>.</p>
<p>The equivalence of a variational form <span class="math">\(a(u,v)=L(v)\ \forall v\in V\)</span> and
the minimization problem <span class="math">\(F(u)\leq F(v)\ \forall v\in V\)</span> requires that
1) <span class="math">\(a\)</span> is bilinear and <span class="math">\(L\)</span> is linear, 2) <span class="math">\(a(u,v)\)</span> is symmetric:
<span class="math">\(a(u,v)=a(v,u)\)</span>, and 3) that <span class="math">\(a(v,v)&gt;0\)</span>.</p>
</div>
<div class="section" id="minimization-of-the-discretized-functional">
<h2>Minimization of the discretized functional<a class="headerlink" href="#minimization-of-the-discretized-functional" title="Permalink to this headline">¶</a></h2>
<p>Inserting <span class="math">\(v=\sum_j c_j{\psi}_j\)</span> turns minimization of <span class="math">\(F(v)\)</span> into
minimization of a quadratic function of the parameters <span class="math">\(c_0,\ldots,c_N\)</span>:</p>
<div class="math">
\[\bar F(c_0,\ldots,c_N) = \sum_{j\in{\mathcal{I}_s}}\sum_{i\in{\mathcal{I}_s}} a({\psi}_i,{\psi}_j)c_ic_j - \sum_{j\in{\mathcal{I}_s}} L({\psi}_j)c_j\]</div>
<p>of <span class="math">\(N+1\)</span> parameters.</p>
<p>Minimization of <span class="math">\(\bar F\)</span> implies</p>
<div class="math">
\[\frac{\partial\bar F}{\partial c_i}=0,\quad i\in{\mathcal{I}_s}{\thinspace .}\]</div>
<p>After some algebra one finds</p>
<div class="math">
\[\sum_{j\in{\mathcal{I}_s}} a({\psi}_i,{\psi}_j)c_j = L({\psi}_i),\quad i\in{\mathcal{I}_s},\]</div>
<p>which is the same system as the one arising from <span class="math">\(a(u,v)=L(v)\)</span>.</p>
</div>
<div class="section" id="calculus-of-variations">
<h2>Calculus of variations<a class="headerlink" href="#calculus-of-variations" title="Permalink to this headline">¶</a></h2>
<p>A branch of applied mathematics, called <a class="reference external" href="https://en.wikipedia.org/wiki/Calculus_of_variations">calculus of variations</a>, deals
with the technique of minimizing functionals to derive differential
equations. The technique involves taking the <em>variation</em> (a kind of
derivative) of functionals, which have given name to
terms like variational form, variational
problem, and variational formulation.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Abstract notation for variational formulations</a></li>
<li><a class="reference internal" href="#variational-problems-and-minimization-of-functionals">Variational problems and minimization of functionals</a><ul>
<li><a class="reference internal" href="#example-4">Example</a></li>
<li><a class="reference internal" href="#the-general-minimization-problem">The general minimization problem</a></li>
<li><a class="reference internal" href="#derivation">Derivation</a></li>
<li><a class="reference internal" href="#minimization-of-the-discretized-functional">Minimization of the discretized functional</a></li>
<li><a class="reference internal" href="#calculus-of-variations">Calculus of variations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book015.html"
                        title="previous chapter">Variational formulations with global basis functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book017.html"
                        title="next chapter">Examples on variational formulations</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book016.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book017.html" title="Examples on variational formulations"
             >next</a> |</li>
        <li class="right" >
          <a href="._book015.html" title="Variational formulations with global basis functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Introduction to Numerical Methods for Variational Problems</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2016, Hans Petter Langtangen, Kent-Andre Mardal. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>